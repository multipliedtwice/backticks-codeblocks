"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.processText=void 0;const e="```",r="[^\\S\\r\\n]*",t="([\\s\\S]*?)",s="```",p=new RegExp(e+r+t+r+s,"gs"),g="ESC_TICK",n=/(?<!`)`(?!`)(.*?)`(?!`)/g,o=(e,r,t)=>e.replace(r,t),c=e=>o(e,/\\`/g,g),l=e=>o(e,/```[\s]*``` /g,""),x=(e,r,t)=>e.substring(r,t),a=(e,r)=>{let t=e[1];return r||(t=o(t,/`/g,"")),{code:o(t,new RegExp(g,"g"),"`"),isBlock:r}},u=(e,r,t)=>{t<r.length&&e.push(x(r,t))},i=(e,r,t,s)=>{t<s&&e.push(x(r,t,s))},E=(e,r,t)=>{e.push(a(r,t))},d=(e,r)=>(r.forEach((([r,t])=>{e=e.replace(r,t)})),e),f=(e,r)=>(r.forEach((([r,t])=>{e=e.replace(new RegExp(t,"g"),r.source.replace(/\\("|')/g,"$1"))})),e),w=(e,r,t)=>{const s=[];let p,g=0;for(;null!==(p=e.exec(t));)i(s,t,g,p.index),E(s,p,r),g=e.lastIndex;return u(s,t,g),s},R=e=>"string"==typeof e,h=e=>""!==e.trim(),y=e=>R(e)&&h(e),S=e=>!R(e)&&h(e.code),T=e=>R(e)?w(n,!1,e):[e],$=e=>y(e)||S(e),_=[[new RegExp('"```\\n"'.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"!!!1"],[new RegExp('"```"',"g"),"!!!2"],[new RegExp("'```\\n'","g"),"!!!3"],[new RegExp("'```'","g"),"!!!4"]],b=(e,r)=>{const t=r||_;e=d(e,t),e=c(e),e=l(e);let s=w(p,!0,e).filter($).flatMap(T);return s=s.map((e=>"string"==typeof e?f(e,t):{...e,code:f(e.code,t)})),s};exports.processText=b;